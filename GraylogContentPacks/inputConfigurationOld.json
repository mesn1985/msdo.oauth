{
  "v": 1,
  "id": "eb62fdbb-604e-42bd-85ad-af7794181259",
  "rev": 1,
  "name": "OAuth token flow tracking",
  "summary": "This contents pacp supports a visualization of token flow in OAuth",
  "description": "",
  "vendor": "mesn",
  "url": "",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "8289c217-bbe2-4d2c-b2ce-7b974bf71995",
      "data": {
        "title": {
          "@type": "string",
          "@value": "OAuthTokenTracingPipeline"
        },
        "description": {
          "@type": "string",
          "@value": "pipeline  used for OAuth token tracing"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"OAuthTokenTracingPipeline\"\nstage 0 match pass\nrule \"Drop messages without correlation id value\"\nstage 2 match all\nrule \"Add false value to isPartOfOAuthFlow field\"\nstage 1 match pass\nrule \"Is client requesting access token\"\nrule \"Authorization Server  issued a token for client\"\nrule \"Client obtained access token\"\nrule \"Client requests access to protected resource\"\nrule \"Authorized request for protected resource was made\"\nrule \"Protected resource  retrieved\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "c80e47f6-5b5b-4378-a561-c7801a9c1b90"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "30ebfd1e-9735-4493-9298-5c8877dcb864",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Client obtained access token"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Client obtained access token\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"Obtained Access token\",\n  ignore_case: false\n)\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"true\",\n    clean_field : false\n  );\n  set_field(\n    field : \"OAuthEvent\",\n    value : \"ClientObtainedAccessToken\",\n    clean_field : false\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "68d02c44-3ed6-4a01-9639-98dd25a8c007",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Drop messages without correlation id value"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Drop messages without correlation id value\"\nwhen\n  is_null($message.\"CorrelationId\")\nthen\n  drop_message();\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "a9f619d0-90fb-4a94-84d5-93c671bc2b5d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Is client requesting access token"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Is client requesting access token\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"Requesting access token\",\n  ignore_case: false\n)\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"true\",\n    clean_field : false\n  );\n  set_field(\n    field : \"OAuthEvent\",\n    value : \"ClientTokenRequest\",\n    clean_field : false\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "67402809-b948-474a-8acd-459f7d13435c",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Authorization Server  issued a token for client"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Authorization Server  issued a token for client\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"Access token issued for\",\n  ignore_case: false\n)\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"true\",\n    clean_field : false\n  );\n  set_field(\n    field : \"OAuthEvent\",\n    value : \"AuthorizationServerIssuedAToken\",\n    clean_field : false\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "9481d8b0-5e84-4ed0-96cd-6d38bb0e3766",
      "data": {
        "summary": {
          "@type": "string",
          "@value": "This dashboard shows the flow of token in OAuth"
        },
        "search": {
          "queries": [
            {
              "id": "73731ed4-3227-4126-a493-10a4bd7c9f3f",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": null,
                  "name": "chart",
                  "timerange": {
                    "from": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "latest",
                      "id": "Event the flow was ended with",
                      "field": "OAuthEvent"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "CorrelationId"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "dcc1e022-55a4-4dfc-9e0f-189196f2524c",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "isPartOfOAuthTokenFlow:true"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "card",
                      "id": "card(CorrelationId)",
                      "field": "CorrelationId"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "source"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "abe12537-a4d5-4f7f-ab31-dd2e27da67a8",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "admin",
          "created_at": "2024-05-15T13:26:42.505Z"
        },
        "created_at": "2023-06-01T08:43:23.743Z",
        "requires": {},
        "state": {
          "73731ed4-3227-4126-a493-10a4bd7c9f3f": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "OAuthTokenFlow"
              },
              "widget": {
                "09bb2302-2a92-412c-bd19-9df7500264d1": "Number of distinct correlation id's used in relation OAuth token flow, pr services",
                "ceb56971-4ee3-44d8-a26a-95cd0ca59a01": "Last event in flow(Defined by correlation id)"
              }
            },
            "widgets": [
              {
                "id": "09bb2302-2a92-412c-bd19-9df7500264d1",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 300,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "isPartOfOAuthTokenFlow:true"
                },
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "source"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "card(CorrelationId)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "barmode": "group",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "ceb56971-4ee3-44d8-a26a-95cd0ca59a01",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 300,
                  "type": "relative"
                },
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "table",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "CorrelationId"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Event the flow was ended with"
                      },
                      "function": "latest(OAuthEvent)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": []
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              }
            ],
            "widget_mapping": {
              "09bb2302-2a92-412c-bd19-9df7500264d1": [
                "abe12537-a4d5-4f7f-ab31-dd2e27da67a8"
              ],
              "ceb56971-4ee3-44d8-a26a-95cd0ca59a01": [
                "dcc1e022-55a4-4dfc-9e0f-189196f2524c"
              ]
            },
            "positions": {
              "ceb56971-4ee3-44d8-a26a-95cd0ca59a01": {
                "col": 1,
                "row": 1,
                "height": 4,
                "width": 4
              },
              "09bb2302-2a92-412c-bd19-9df7500264d1": {
                "col": 1,
                "row": 5,
                "height": 4,
                "width": 4
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "admin",
        "title": {
          "@type": "string",
          "@value": "OAuth"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "77cb476b-42a3-4989-bd8c-f22739df0c3d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Protected resource  retrieved"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Protected resource  retrieved\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"Protected Resource retrieved\",\n  ignore_case: false\n)\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"true\",\n    clean_field : false\n  );\n  set_field(\n    field : \"OAuthEvent\",\n    value : \"ProtectedResourceRecieved\",\n    clean_field : false\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "ced55643-0f98-4942-90db-e5608301dc77",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Add false value to isPartOfOAuthFlow field"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Add false value to isPartOfOAuthFlow field\"\nwhen\n  is_null($message.\"isPartOfOAuthTokenFlow\")\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"false\",\n    clean_field : false\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "a2177f72-b1d3-4e01-8b17-a76a93b208fc",
      "data": {
        "summary": {
          "@type": "string",
          "@value": "This is a list of all sources that sent in messages to Graylog."
        },
        "search": {
          "queries": [
            {
              "id": "a1647eb6-a064-4fe6-b459-1e4267d3f659",
              "timerange": {
                "range": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": null,
                  "name": "chart",
                  "timerange": {
                    "range": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Message count",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": false,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "auto",
                        "scaling": 0.25
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "848773e8-20ec-4140-ae11-4d14fdec771e",
                  "filters": [],
                  "column_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "streams"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "sort": []
                },
                {
                  "query": null,
                  "name": "chart",
                  "timerange": {
                    "range": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Message count",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "source"
                      ],
                      "limit": 10,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "22249f29-f042-4bd8-b745-252b00a35891",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "count()",
                      "direction": "Descending"
                    }
                  ]
                },
                {
                  "query": null,
                  "name": "chart",
                  "timerange": {
                    "range": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Message count",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "source"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "5e9a9bfe-7a97-4835-86fd-896f40b20531",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "count()",
                      "direction": "Descending"
                    }
                  ]
                },
                {
                  "query": null,
                  "name": "chart",
                  "timerange": {
                    "range": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Message count",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": false,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "auto",
                        "scaling": 1
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "9333f7ef-11ad-4bd2-967f-29288e1d254b",
                  "filters": [],
                  "column_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "gl2_source_input"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "sort": []
                },
                {
                  "query": null,
                  "name": "chart",
                  "timerange": {
                    "range": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Message count",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": false,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "auto",
                        "scaling": 1
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "f1c5d593-3831-42e2-b8f8-5107abc380db",
                  "filters": [],
                  "column_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "gl2_source_node"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "sort": []
                }
              ]
            },
            {
              "id": "be9fdec2-0d46-4219-9860-b26ba839d2b4",
              "timerange": {
                "range": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": null,
                  "name": "chart",
                  "timerange": {
                    "range": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "sum",
                      "id": "Message count",
                      "field": "gl2_accounted_message_size"
                    }
                  ],
                  "filter": null,
                  "rollup": false,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "auto",
                        "scaling": 1
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "9a0914fa-c83c-416c-8709-78d5e8cc9657",
                  "filters": [],
                  "column_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "gl2_source_node"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "sort": []
                },
                {
                  "query": null,
                  "name": "chart",
                  "timerange": {
                    "range": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Message count",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "source"
                      ],
                      "limit": 10,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "0892cc6a-0f4e-4886-8835-bc1adf1dc7e9",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": null,
                  "name": "chart",
                  "timerange": {
                    "range": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "sum",
                      "id": "Message count",
                      "field": "gl2_accounted_message_size"
                    }
                  ],
                  "filter": null,
                  "rollup": false,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "auto",
                        "scaling": 0.25
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "85e0eb88-577c-45c1-b91d-7edd165a05d5",
                  "filters": [],
                  "column_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "streams"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "sort": []
                },
                {
                  "query": null,
                  "name": "chart",
                  "timerange": {
                    "range": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "sum",
                      "id": "Message count",
                      "field": "gl2_accounted_message_size"
                    }
                  ],
                  "filter": null,
                  "rollup": false,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "auto",
                        "scaling": 1
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "4cab9d48-a864-420d-a08a-a59ddc5b0b34",
                  "filters": [],
                  "column_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "gl2_source_input"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "sort": []
                },
                {
                  "query": null,
                  "name": "chart",
                  "timerange": {
                    "range": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "sum",
                      "id": "Messages size",
                      "field": "gl2_accounted_message_size"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "source"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "4e285e1f-5675-4005-9634-0e9d4181dd08",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "admin",
          "created_at": "2023-06-01T12:37:51.057Z"
        },
        "created_at": "2023-06-01T08:43:23.743Z",
        "requires": {},
        "state": {
          "a1647eb6-a064-4fe6-b459-1e4267d3f659": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "Log Volume by Message Count"
              },
              "widget": {
                "6c127c5d-be75-4157-b43f-ac0194ac0586": "Selected sources",
                "92d63811-e4dd-47db-bd3b-db03c8a9bd53": "Messages per Source",
                "00637e63-d728-4b3e-932b-7c8696b4855d": "Messages over time",
                "8850cc37-1877-4963-a518-b33e21599ebd": "Messages over time by Streams",
                "5de0575e-094c-4234-96b2-042fc4f069ec": "Messages over time by Inputs",
                "219f666b-8a98-468f-b1db-5841c89827d3": "Messages over time by Nodes"
              }
            },
            "widgets": [
              {
                "id": "6c127c5d-be75-4157-b43f-ac0194ac0586",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 300,
                  "type": "relative"
                },
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "table",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "source"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Message count"
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "count()",
                      "direction": "Descending"
                    }
                  ]
                }
              },
              {
                "id": "5de0575e-094c-4234-96b2-042fc4f069ec",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 300,
                  "type": "relative"
                },
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": 15,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 1
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Message count"
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [
                    {
                      "fields": [
                        "gl2_source_input"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "visualization_config": {
                    "barmode": "stack",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "8850cc37-1877-4963-a518-b33e21599ebd",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 300,
                  "type": "relative"
                },
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": 15,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 0.25
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Message count"
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [
                    {
                      "fields": [
                        "streams"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "visualization_config": {
                    "barmode": "stack",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "92d63811-e4dd-47db-bd3b-db03c8a9bd53",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 300,
                  "type": "relative"
                },
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "pie",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 10,
                  "row_pivots": [
                    {
                      "fields": [
                        "source"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 10
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Message count"
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "count()",
                      "direction": "Descending"
                    }
                  ]
                }
              },
              {
                "id": "219f666b-8a98-468f-b1db-5841c89827d3",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 300,
                  "type": "relative"
                },
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": 15,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 1
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Message count"
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [
                    {
                      "fields": [
                        "gl2_source_node"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "visualization_config": {
                    "barmode": "stack",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              }
            ],
            "widget_mapping": {
              "92d63811-e4dd-47db-bd3b-db03c8a9bd53": [
                "22249f29-f042-4bd8-b745-252b00a35891"
              ],
              "8850cc37-1877-4963-a518-b33e21599ebd": [
                "848773e8-20ec-4140-ae11-4d14fdec771e"
              ],
              "6c127c5d-be75-4157-b43f-ac0194ac0586": [
                "5e9a9bfe-7a97-4835-86fd-896f40b20531"
              ],
              "5de0575e-094c-4234-96b2-042fc4f069ec": [
                "9333f7ef-11ad-4bd2-967f-29288e1d254b"
              ],
              "219f666b-8a98-468f-b1db-5841c89827d3": [
                "f1c5d593-3831-42e2-b8f8-5107abc380db"
              ]
            },
            "positions": {
              "92d63811-e4dd-47db-bd3b-db03c8a9bd53": {
                "col": 7,
                "row": 9,
                "height": 4,
                "width": 6
              },
              "6c127c5d-be75-4157-b43f-ac0194ac0586": {
                "col": 1,
                "row": 9,
                "height": 4,
                "width": 6
              },
              "8850cc37-1877-4963-a518-b33e21599ebd": {
                "col": 1,
                "row": 1,
                "height": 4,
                "width": "Infinity"
              },
              "5de0575e-094c-4234-96b2-042fc4f069ec": {
                "col": 1,
                "row": 5,
                "height": 4,
                "width": 6
              },
              "219f666b-8a98-468f-b1db-5841c89827d3": {
                "col": 7,
                "row": 5,
                "height": 4,
                "width": 6
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          },
          "be9fdec2-0d46-4219-9860-b26ba839d2b4": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "Log Volume by Message Size"
              },
              "widget": {
                "2a5904f0-bffb-433c-9648-163cf925c878": "Selected sources",
                "d3d3f4dc-ced0-46b0-b65d-981897c5d94b": "Messages per Source",
                "undefined": "Messages over time",
                "e3016dd4-6586-400c-a214-538a29d5a641": "Messages over time by Streams",
                "7e6a1cb8-9aac-470d-9f74-19d274703b1d": "Messages over time by Inputs",
                "2d7970aa-0e35-4ac0-ac35-2f357c82c877": "Messages over time by Nodes"
              }
            },
            "widgets": [
              {
                "id": "2d7970aa-0e35-4ac0-ac35-2f357c82c877",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 300,
                  "type": "relative"
                },
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": 15,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 1
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Message count"
                      },
                      "function": "sum(gl2_accounted_message_size)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [
                    {
                      "fields": [
                        "gl2_source_node"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "visualization_config": {
                    "barmode": "stack",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "e3016dd4-6586-400c-a214-538a29d5a641",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 300,
                  "type": "relative"
                },
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": 15,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 0.25
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Message count"
                      },
                      "function": "sum(gl2_accounted_message_size)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [
                    {
                      "fields": [
                        "streams"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "visualization_config": {
                    "barmode": "stack",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "7e6a1cb8-9aac-470d-9f74-19d274703b1d",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 300,
                  "type": "relative"
                },
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": 15,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 1
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Message count"
                      },
                      "function": "sum(gl2_accounted_message_size)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [
                    {
                      "fields": [
                        "gl2_source_input"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "visualization_config": {
                    "barmode": "stack",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "d3d3f4dc-ced0-46b0-b65d-981897c5d94b",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 300,
                  "type": "relative"
                },
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "pie",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 10,
                  "row_pivots": [
                    {
                      "fields": [
                        "source"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 10
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Message count"
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "2a5904f0-bffb-433c-9648-163cf925c878",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 300,
                  "type": "relative"
                },
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "table",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "source"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Messages size"
                      },
                      "function": "sum(gl2_accounted_message_size)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": []
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              }
            ],
            "widget_mapping": {
              "d3d3f4dc-ced0-46b0-b65d-981897c5d94b": [
                "0892cc6a-0f4e-4886-8835-bc1adf1dc7e9"
              ],
              "e3016dd4-6586-400c-a214-538a29d5a641": [
                "85e0eb88-577c-45c1-b91d-7edd165a05d5"
              ],
              "2a5904f0-bffb-433c-9648-163cf925c878": [
                "4e285e1f-5675-4005-9634-0e9d4181dd08"
              ],
              "7e6a1cb8-9aac-470d-9f74-19d274703b1d": [
                "4cab9d48-a864-420d-a08a-a59ddc5b0b34"
              ],
              "2d7970aa-0e35-4ac0-ac35-2f357c82c877": [
                "9a0914fa-c83c-416c-8709-78d5e8cc9657"
              ]
            },
            "positions": {
              "d3d3f4dc-ced0-46b0-b65d-981897c5d94b": {
                "col": 7,
                "row": 9,
                "height": 4,
                "width": 6
              },
              "2a5904f0-bffb-433c-9648-163cf925c878": {
                "col": 1,
                "row": 9,
                "height": 4,
                "width": 6
              },
              "e3016dd4-6586-400c-a214-538a29d5a641": {
                "col": 1,
                "row": 1,
                "height": 4,
                "width": "Infinity"
              },
              "7e6a1cb8-9aac-470d-9f74-19d274703b1d": {
                "col": 1,
                "row": 5,
                "height": 4,
                "width": 6
              },
              "2d7970aa-0e35-4ac0-ac35-2f357c82c877": {
                "col": 7,
                "row": 5,
                "height": 4,
                "width": 6
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "admin",
        "title": {
          "@type": "string",
          "@value": "Sources"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": "This is a list of all sources that sent in messages to Graylog. You can narrow the timerange by zooming in on the message histogram, or you can increase the time range by specifying a broader one in the controls at the top. You can also specify filters to limit the results you are seeing. You can also add additional widgets to this dashboard, or adapt the appearance of existing widgets to suit your needs."
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "1bf4e9c3-3b0d-44bd-aae8-18bae8ac321a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Client requests access to protected resource"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Client requests access to protected resource\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"Request for protected resource sent\",\n  ignore_case: false\n)\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"true\",\n    clean_field : false\n  );\n  set_field(\n    field : \"OAuthEvent\",\n    value : \"ClientRequestForProtectedResource\",\n    clean_field : false\n  );\nend\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "d67e5abc-e4d9-4ceb-8e7c-eda0d40460d9",
      "data": {
        "title": {
          "@type": "string",
          "@value": "OAuthTracing"
        },
        "configuration": {
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 262144
          },
          "port": {
            "@type": "integer",
            "@value": 12201
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 8
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "decompress_size_limit": {
            "@type": "integer",
            "@value": 8388608
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.gelf.udp.GELFUDPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "279ffada-ce53-4cdc-aaa1-7f63a5c7cfa1",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Authorized request for protected resource was made"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Authorized request for protected resource was made\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"Authorized Request for protected resource\",\n  ignore_case: false\n)\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"true\",\n    clean_field : false\n  );\n  set_field(\n    field : \"OAuthEvent\",\n    value : \"AuthorizedReqeustForProtectedResourceWasMade\",\n    clean_field : false\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream_title",
        "version": "1"
      },
      "id": "c80e47f6-5b5b-4378-a561-c7801a9c1b90",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Default Stream"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    }
  ]
}