{
  "v": 1,
  "id": "2c4ca475-eef4-4191-a0e2-deae30f993b8",
  "rev": 1,
  "name": "OAuthTokenTracing",
  "summary": "Content pack  used for  tracing OAuth token flows",
  "description": "",
  "vendor": "MESN",
  "url": "",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "7c4362a6-930c-48c9-85c6-ceb856b4123d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Protected resource  retrieved"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Protected resource  retrieved\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"Protected Resource retrieved\",\n  ignore_case: false\n)\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"true\",\n    clean_field : false\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "fb757297-f8fd-48d2-a689-d2f4895e2a2d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Is client requesting access token"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Is client requesting access token\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"Requesting access token\",\n  ignore_case: false\n)\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"true\",\n    clean_field : false\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "8e076230-14c6-4c48-ae3c-d6d75371aeb0",
      "data": {
        "title": {
          "@type": "string",
          "@value": "OAuthTracing"
        },
        "configuration": {
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 262144
          },
          "port": {
            "@type": "integer",
            "@value": 12201
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 8
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "decompress_size_limit": {
            "@type": "integer",
            "@value": 8388608
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.gelf.udp.GELFUDPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "dc50c53f-fd1e-45f7-8174-78e7eaaf16fc",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Drop messages that does not have correlation id"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Drop messages that does not have correlation id\"\nwhen\n  true\nthen\n\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "2506cf75-7b6d-4655-a712-0de531513eb0",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Client requests access to protected resource"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Client requests access to protected resource\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"Request for protected resource sent\",\n  ignore_case: false\n)\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"true\",\n    clean_field : false\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "6f94dec3-af2c-4c36-8fd0-56765e22e402",
      "data": {
        "title": {
          "@type": "string",
          "@value": "OAuthTokenTracingPipeline"
        },
        "description": {
          "@type": "string",
          "@value": "pipeline  used for OAuth token tracing"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"OAuthTokenTracingPipeline\"\nstage 0 match all\nrule \"Drop messages that does not have correlation id\"\nstage 1 match either\nrule \"Is client requesting access token\"\nrule \"Authorization Server  issued a token for client\"\nrule \"Client obtained access token\"\nrule \"Client requests access to protected resource\"\nrule \"Authorized request for protected resource was made\"\nrule \"Protected resource  retrieved\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "a74f6222-a770-4cfd-8292-66e8d92912fe"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "2999fabe-4f80-40f8-853d-c2f405f4f6c7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Authorized request for protected resource was made"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Authorized request for protected resource was made\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"Authorized Request for protected resource\",\n  ignore_case: false\n)\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"true\",\n    clean_field : false\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "9489502a-5513-42e9-b482-875b58174266",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Authorization Server  issued a token for client"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Authorization Server  issued a token for client\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"Access token issued for\",\n  ignore_case: false\n)\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"true\",\n    clean_field : false\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "3acad700-1b10-449c-9ca0-067c179eec56",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Client obtained access token"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Client obtained access token\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"Obtained Access token\",\n  ignore_case: false\n)\nthen\n  set_field(\n    field : \"isPartOfOAuthTokenFlow\",\n    value : \"true\",\n    clean_field : false\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream_title",
        "version": "1"
      },
      "id": "a74f6222-a770-4cfd-8292-66e8d92912fe",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Default Stream"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.7+5e29a2c"
        }
      ]
    }
  ]
}